稀疏矩阵的存储方式

0 1 1 0 0
1 0 1 1 0
1 1 0 1 0
0 1 1 0 1
0 0 0 1 0

coc:
data=\[1 1 1 1 1 1 1 1 1 1 1 1\]
rows=\[0 0 1 1 1 2 2 2 3 3 3 4\]
cols=\[1 2 0 2 3 0 1 3 1 2 4 3\]

csr:
data=\[1 1 1 1 1 1 1 1 1 1 1 1\]
indices=cols=\[1 2 0 2 3 0 1 3 1 2 4 3\]
ind_ptr=\[0 2 5 8 11 12\]
ind_ptr\[i+1\] - ind_ptr\[i\]表示第i行中的数据个数，并且在indices中可读出每个数据的所在列


crc:
data=\[1 1 1 1 1 1 1 1 1 1 1 1\]
indices=cols=\[1 2 0 2 3 0 1 3 1 2 4 3\]
ind_ptr=\[0 2 5 8 11 12\]
ind_ptr\[i+1\] - ind_ptr\[i\]表示第i列中的数据个数，并且在indices中可读出每个数据的所在行

将图应用于机器学习的挑战
1.图缺乏一致的结构
2.每个节点并不是相互独立的，存在连接性
3.图的存储问题，连接性是用邻接矩阵来存储，如果图非常大存储不下来。由于邻接矩阵很稀疏，所以用稀疏矩阵来存储会更好，而稀疏矩阵在GPU上训练一直是个技术难题。
4.置换不变性，邻接矩阵任意交换行列，会导致邻接矩阵改变，他们其实节点关系不变。
节点顺序等变性

图神经网络与图核方法：？


![图神经网络分类](https://raw.githubusercontent.com/zjc0000/story_images/main/小书匠/1665814700600.png)
循环图神经网络（RGNN）：假设图中的一个节点不断与其邻居交换信息/消息，直到达到稳定的平衡

卷积图神经网络（CGNN）：是通过汇总节点自身的特征Xv和相邻节点的特征Xu来生成节点v的表征形式
（1）基于谱方法
（2）基于空间方法

（1）节点分类：信息传递，最后的节点能够学习到离它很远邻居节点的特征
![](https://raw.githubusercontent.com/zjc0000/story_images/main/小书匠/1665818817431.png)
（2）图分类：通过池化层将图变成子图，从而学习到图高级特征，通过读出层综合这些特征
![](https://raw.githubusercontent.com/zjc0000/story_images/main/小书匠/1665818828585.png)

图自动编码器（GAE）：用与获取网络嵌入embedding向量,基于自编码器
![](https://raw.githubusercontent.com/zjc0000/story_images/main/小书匠/1665817914133.png)
图自动编码器（VGAE）：图生成：基于变分自编码器（VGAE）

自编码器（AE）：自编码器属于嵌入与表征学习的一种，主要用于数据降维、压缩以及获取低维度表征等。
自编码器可以可以完美的恢复出输入，但是由于损失函数是直接度量重建样本与真实样本的底层特征之间的距离，而不是评价重建样本的逼真度和多样性等抽象指标，在数据生成任务上表现一般。
![](https://raw.githubusercontent.com/zjc0000/story_images/main/小书匠/1665818615987.png)
变分自编码器（VAE）：变分自编码器可以定义为一种自编码器，其训练经过正规化以避免过度拟合，并确保隐空间具有能够进行**数据生成过程**的良好属性

时空图神经网络（STGNN）：同时考虑空间依赖性和时间依赖性。许多当前的方法将图卷积与RNN或CNN集成在一起以捕获空间依赖性，从而对时间依赖性进行建模。
用于：交通速度预测，驾驶员操作预期和人类行为识别等
![](https://raw.githubusercontent.com/zjc0000/story_images/main/小书匠/1665819600788.png)

节点级任务：节点回归，节点分类  通过信息传播/图卷积来提取节点高级特征，使用多层感知器或softmax层作为输出层，GNN能够以端到端的方式执行节点级任务。
边级任务：边分类，连接预测  将来自GNN的两个节点的隐藏表征作为输入，可以利用相似度函数或神经网络来预测边的标签/连接强度。
图级任务：图分类(监督学习) 通过池化层将图变成子图，从而学习到图高级特征，通过读出层综合这些特征;图嵌入(无监督学习) 通过图自动编码器或变分图自动编码器

https://zhuanlan.zhihu.com/p/200888266
https://arxiv.org/pdf/1901.00596.pdf#page=18&zoom=100,65,949


![](https://raw.githubusercontent.com/zjc0000/story_images/main/小书匠/1666228669069.png)



基于云边协同的ROI视频编码系统通用架构

![基于云边协同的ROI视频编码系统通用架构](https://raw.githubusercontent.com/zjc0000/story_images/main/小书匠/1666230684723.png)
流程：云服务器找到ROI区域反馈给边缘，边缘仅对每帧的ROI区域进行编码上传给云端分析
（1）edge-cloud 的反馈延迟非常大导致边缘设备存在一定的空闲时间；

![](https://raw.githubusercontent.com/zjc0000/story_images/main/小书匠/1666232841254.png)
上图为edge-cloud 的反馈延迟非常大导致边缘设备存在一定的空闲时间，通常解决办法是使用目标移动预测算法补偿反馈延迟，下图为边缘预测错误，又将错误的ROI区域编码上传给云端，导致云端分析错误

（2）上传的帧是基于之前发现的ROI进行编码的，其中只包含旧目标，使得云端无法获得新目标。
改进1：上传低质量的非ROI区域给云端以获得新目标 vs.仍需要额外的带宽
B. A. Mudassar, J. H. Ko, and S. Mukhopadhyay, “Edge-cloud collaborative processing for intelligent internet of things: A case study onsmart surveillance,” in 2018 55th ACM/ESDA/IEEE Design Automation Conference (DAC). IEEE, 2018, pp. 1–6.
改进2：将视频分为关键帧和非关键帧，关键帧（包含非ROI区域）全部上传给云端，非关键帧在边缘用于目标跟踪
假设出现了新目标，云端在关键帧上传并接收到反馈前，不能在非关键帧进行新目标的跟踪。
（1）根据新目标出现的频率，动态调整发送关键帧间隔，以平衡带宽与准确率。将每个帧都定义为关键帧上传云端分析可获得最高准确率，但需要最高带宽资源。
（2）需要新算法找到ROI区域的丢失并重新找到非关键帧里新目标的位置。
![](https://raw.githubusercontent.com/zjc0000/story_images/main/小书匠/1666233536553.png)
H. Gu, Z. Ge, E. Cao, M. Chen, T. Wei, X. Fu et al., “A collaborative and sustainable edge-cloud architecture for object tracking with convolutional siamese networks,” IEEE Transactions on Sustainable Computing,2019.

PETRI整体架构
![](https://raw.githubusercontent.com/zjc0000/story_images/main/小书匠/1666235794503.png)

（1）为避免边缘长时间的空闲，通过多任务并行处理帧的上传。每一个任务包括一个关键帧和多个非关键帧。通过接收云端未被追踪到的目标的比例来动态调整非关键帧的个数。该值越高关键帧的比例越高以提高准确率。

![](https://raw.githubusercontent.com/zjc0000/story_images/main/小书匠/1666236381272.png)
